<mat-card appearance="outlined" class="form-card">
  <!-- <mat-card-header>
  <mat-card-title>Sesi√≥n de venta</mat-card-title>
</mat-card-header> -->
<mat-card-content>
  <div class="row">
    <div class="col">
      <mat-form-field class="filter-select" appearance="outline">
        <mat-label>Selecciona zona</mat-label>
        <mat-select [(ngModel)]="selectedZone" (selectionChange)="loadRemote(selectedZone._id)" panelClass="custom-select-panel">
          @for (zona of zonas; track zona) {
            <mat-option [value]="zona"> {{zona.name}} </mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col">
      @if (selectedZone) {
        <mat-form-field class="filter-select" appearance="outline">
          <mat-label>Selecciona una sucursal</mat-label>
          <mat-select [(ngModel)]="selectedSuc" (selectionChange)="loadRemote(null, selectedSuc._id)">
            <mat-option value="all"> Todas </mat-option>
            @for (s of sucursales; track s) {
              <mat-option [value]="s"> {{s.name}} </mat-option>
            }
          </mat-select>
        </mat-form-field>
      }
    </div>
  </div>
</mat-card-content>
</mat-card>
<!--POLLO-->
<div class="row">
  @for (sdate of status; track sdate) {
    <div class="col">
      <mat-card class="form-card">
        @if (sdate.date === today) {
          <mat-card-title>{{ sdate.date | amLocale:'es' | amCalendar: {sameDay:'[Hoy]'} }}</mat-card-title>
        }
        @if (sdate.date !== today) {
          <mat-card-title>{{ sdate.date | amLocale:'es' | amTimeAgo | titlecase }}</mat-card-title>
        }
        <mat-card-content>
          @if (sdate.sucursales.length === 0) {
            <div>No hay ventas registradas.</div>
          }
          @for (sucursal of sdate.sucursales; track sucursal) {
            <div>
              <h3>{{ sucursal._id | titlecase }}</h3>
              @if (sucursal.productos.length === 0) {
                <div class="col">No hay productos registrados.</div>
              }
              @if (sucursal.productos.length !== 0) {
                <div class="col">
                  <table mat-table [dataSource]="sucursal.productos" class="mat-elevation-z8">
                    <ng-container matColumnDef="nombre">
                      <th mat-header-cell *matHeaderCellDef> Nombre </th>
                      <td mat-cell *matCellDef="let element"> {{element.nombre | titlecase }}
                      </td>
                    </ng-container>
                    <ng-container matColumnDef="total">
                      <th mat-header-cell *matHeaderCellDef> Total </th>
                      <td mat-cell *matCellDef="let element"> {{element.total}}
                      </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="productColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: productColumns;"></tr>
                  </table>
                </div>
              }
            </div>
          }
        </mat-card-content>
      </mat-card>
    </div>
  }
</div>
<!--NUEVO DE PIERNA Y MUSLO-->
<div class="row">
  @for (sdate of statusPM; track sdate) {
    <div class="col">
      <mat-card class="form-card">
        @if (sdate.date === today) {
          <mat-card-title>{{ sdate.date | amLocale:'es' | amCalendar: {sameDay:'[Hoy]'} }}</mat-card-title>
        }
        @if (sdate.date !== today) {
          <mat-card-title>{{ sdate.date | amLocale:'es' | amTimeAgo | titlecase }}</mat-card-title>
        }
        <mat-card-content>
          @if (sdate.sucursales.length === 0) {
            <div>No hay ventas registradas.</div>
          }
          @for (sucursal of sdate.sucursales; track sucursal) {
            <div>
              <h3>{{ sucursal._id | titlecase }}</h3>
              @if (sucursal.productos.length === 0) {
                <div class="col">No hay productos registrados.</div>
              }
              @if (sucursal.productos.length !== 0) {
                <div class="col">
                  <table mat-table [dataSource]="sucursal.productos" class="mat-elevation-z8">
                    <ng-container matColumnDef="nombre">
                      <th mat-header-cell *matHeaderCellDef> Nombre </th>
                      <td mat-cell *matCellDef="let element"> {{element.nombre | titlecase }}
                      </td>
                    </ng-container>
                    <ng-container matColumnDef="total">
                      <th mat-header-cell *matHeaderCellDef> Total </th>
                      <td mat-cell *matCellDef="let element"> {{element.total}}
                      </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="productColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: productColumns;"></tr>
                  </table>
                </div>
              }
            </div>
          }
        </mat-card-content>
      </mat-card>
    </div>
  }
</div>
<!-- <ngx-loading [show]="loading" [config]="{ fullScreenBackdrop:true }"></ngx-loading> -->
<ngx-spinner type="pacman"></ngx-spinner>
